estate_merchants =
{
	icon = 3
	
	color = { 133 235 113 }
	
	keep_on_conquest = no 							
	always_remove_on_religious_conquest = yes 	
		
	min_autonomy = 25							
    autonomy_does_not_affect = province_trade_power_modifier
    
    custom_name = {
		desc = estate_builders
		trigger = {
            has_reform = nights_watch_reform
		}
	}
    
    # ----- Conditions -----
	trigger = {
		NOT = { has_reform = wildling_clan_reform }
        NOT = { government = nomadic }
	}
	
	province_trigger = {
		always = yes
	}

	# ----- Country -----
	# These scale with loyalty & power
	country_modifier_happy = {
		global_trade_power = 0.1
		global_trade_goods_size_modifier = 0.1
		trade_efficiency = 0.1
	}
	country_modifier_neutral = {
		trade_efficiency = 0.05
	}	
	country_modifier_angry = {
		global_trade_power = -0.1
		global_trade_goods_size_modifier = -0.1
		trade_efficiency = -0.1
	}	
	
	# ----- Province -----
	province_modifier_happy = {
		province_trade_power_modifier = 0.5
		local_unrest = -5
	}
	province_modifier_neutral = {
		province_trade_power_modifier = 0.25
		local_unrest = -1
	}	
	province_modifier_angry = {
		province_trade_power_modifier = -0.5
		local_unrest = 5
	}	
	
    ai_grant_province = {
        factor = 1    
        modifier = {
            factor = 2
            development = 20
        }
        modifier = {
            factor = 0.5
            NOT = { development = 10 }
        }                
        modifier = {
            factor = 2
            province_trade_power = 5
        }            
        modifier = {
            factor = 3
            province_trade_power = 10
        }
        modifier = {
            factor = 4
            local_autonomy = 25
        }
        modifier = {
            factor = 0.25
            NOT = { local_autonomy = 25 }
        }
    }
    
    # ----- Territory -----
    min_territory = 15
    min_provinces_to_want_territory = 10
    
	# ----- Influence -----
	base_influence = 20
	
	influence_modifier = {
		desc = EST_VAL_OTHER_ESTATE_IN_POWER
		trigger = {
			OR = {
				has_country_flag = noble_estate_in_power
                has_country_flag = clergy_estate_in_power
                has_country_flag = commoner_estate_in_power
                has_country_flag = kos_estate_in_power
                has_country_flag = chieftains_estate_in_power
                has_country_flag = magi_estate_in_power
			}
		}
		influence = -40
	}
	
	# Trade Income
	influence_modifier = {
		desc = EST_VAL_TRADE_INCOME
		trigger = {
			num_of_owned_provinces_with = {
                value = 5
                OR = {
                    has_province_modifier = important_natural_harbor
                    has_province_modifier = center_of_trade_modifier
                    has_province_modifier = inland_center_of_trade_modifier
                    has_province_modifier = trade_post_modifier
                }
            }
		}
		influence = 10
	}

	# ----- Loyalty -----
	loyalty_modifier = {
		desc = EST_VAL_OTHER_ESTATE_IN_POWER_LOY
		trigger = {
			OR = {
				has_country_flag = noble_estate_in_power
                has_country_flag = clergy_estate_in_power
                has_country_flag = commoner_estate_in_power
                has_country_flag = kos_estate_in_power
                has_country_flag = chieftains_estate_in_power
                has_country_flag = magi_estate_in_power
			}
		}
		loyalty = -40
	}
	
	loyalty_modifier = {
		desc = EST_VAL_MERCANTILISM
        
		trigger = {
			mercantilism = 25
            NOT = { mercantilism = 50 }
		}
		loyalty = 5
	}
    
    loyalty_modifier = {
		desc = EST_VAL_MERCANTILISM
        
		trigger = {
			mercantilism = 50
            NOT = { mercantilism = 75 }
		}
		loyalty = 10
	}
    
    loyalty_modifier = {
		desc = EST_VAL_MERCANTILISM
        
		trigger = {
			mercantilism = 75
		}
		loyalty = 15
	}
    
	# ----- Interactions -----
    # Favour Chosen Merchants
    interaction = {
        name = "FAVOUR_CHOSEN_MERCHANTS"
        icon = 1
        
        years_between_use = 20
        
        potential = { }
        
        trigger = {        
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }    
            estate_influence = {
                estate = estate_merchants
                influence = 25
            }            
        }
        
        effect = {
            add_scaled_dip_power = { ESTATE = estate_merchants }
            
            add_estate_loyalty = {
                estate = estate_merchants
                loyalty = -20
            }
        }
        
        ai_will_do = {
            factor = 0        
        }
    }
    
    # Fund Merchant Guilds
    interaction = {
        name = "FUND_MERCHANT_GUILDS"
        icon = 1
        
        years_between_use = 10
        
        potential = { }
        
        trigger = {
            always = yes
        }
        
        effect = {
            add_years_of_income = -0.5
            
            add_estate_loyalty = {
                estate = estate_merchants
                loyalty = 15
            }
        }
        
        ai_will_do = {
            factor = 1
            modifier = {
                factor = 0
                NOT = { years_of_income = 0.5 }                
            }
            modifier = {
                factor = 0
                estate_loyalty = {
                    estate = estate_merchants
                    loyalty = 40
                }
            }            
        }        
    }
    
    # Seek Support of Merchants
    interaction = {
        name = "SEEK_SUPPORT_OF_MERCHANTS"
        icon = 1
        
        years_between_use = 20
        
        trigger = {
            always = yes
        }
        
        effect = {
            add_estate_loyalty = {
                estate = estate_merchants
                loyalty = 10
            }
            add_estate_influence_modifier = {
                estate = estate_clergy
                desc = EST_VAL_SUPPORT_OF_MERCHANTS
                influence = 10
                duration = 7300
            }
        }
    
        ai_will_do = {
            factor = 1
            modifier = {
                factor = 0
                estate_loyalty = {
                    estate = estate_merchants
                    loyalty = 30
                }                        
            }
            modifier = {
                factor = 0
                estate_influence = {
                    estate = estate_merchants
                    influence = 60
                }                        
            }            
        }
    }
    
    # Recruit Trader
    interaction = {
        name = "RECRUIT_TRADER"
        icon = 1
        
        potential = { }
        
        years_between_use = 30
        
        trigger = {
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }
        }
        
        effect = {
            add_scaled_estate_advisor = { 
                ESTATE = estate_merchants 
                ADVISOR = trader
            }
            
            add_estate_influence_modifier = {
                estate = estate_merchants
                desc = EST_VAL_RECRUITED_ADVISOR
                influence = 15
                duration = 10950
            }
        }
        
        
        ai_will_do = {
            factor = 0            
        }
    }
    
    # Recruit Spymaster
    interaction = {
        name = "RECRUIT_SPYMASTER"
        icon = 1
        
        potential = { }
        
        years_between_use = 30
        
        trigger = {
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }
        }
        
        effect = {
            add_scaled_estate_advisor = { 
                ESTATE = estate_merchants 
                ADVISOR = spymaster
            }
            
            add_estate_influence_modifier = {
                estate = estate_merchants
                desc = EST_VAL_RECRUITED_ADVISOR
                influence = 15
                duration = 10950
            }
        }
        
        
        ai_will_do = {
            factor = 0            
        }
    }
    
    # Restrict Exotic Imports
    interaction = {
        name = "RESTRICT_EXOTIC_IMPORTS"
        icon = 1
        
        years_between_use = 10
        
        potential = { }
        
        trigger = {
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }    
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }            
        }
        
        effect = {
            add_scaled_mercantilism = { ESTATE = estate_merchants }
            
            add_estate_influence_modifier = {
                estate = estate_merchants
                desc = EST_VAL_RESTRICTED_IMPORTS
                influence = 15
                duration = 3650
            }
        }
        
        ai_will_do = {
            factor = 1
            
            modifier = {
                factor = 0
                estate_influence = {
                    estate = estate_merchants
                    influence = 40
                }                        
            }
        }
    }
    
    # Appoint Explorer
    interaction = {
        name = "APPOINT_EXPLORER"
        icon = 1
        
        years_between_use = 10
        
        potential = { }
        
        trigger = {
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }    
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }            
        }
        
        effect = {
            add_scaled_conquistador = { ESTATE = estate_merchants }
            
            add_estate_influence_modifier = {
                estate = estate_merchants
                desc = EST_VAL_RECRUITED_LEADER
                influence = 20
                duration = 3650
            }
        }
        
        ai_will_do = {
            factor = 0
        }
    }
    
    # Appoint Naval Explorer
    interaction = {
        name = "APPOINT_NAVAL_EXPLORER"
        icon = 1
        
        years_between_use = 10
        
        potential = { }
        
        trigger = {
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }    
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }            
        }
        
        effect = {
            add_scaled_explorer = { ESTATE = estate_merchants }
            
            add_estate_influence_modifier = {
                estate = estate_merchants
                desc = EST_VAL_RECRUITED_LEADER
                influence = 20
                duration = 3650
            }
        }
        
        ai_will_do = {
            factor = 0
        }
    }
    
    # Enact Mercantile Tax 
    interaction = {
        name = "ENACT_MERCANTILE_TAX"
        icon = 1
        
        years_between_use = 20
        
        potential = { }
        
        trigger = {
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }    
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }            
        }
        
        effect = {
            add_scaled_yearly_gold = { ESTATE = estate_merchants }
            
            add_estate_loyalty = {
                estate = estate_merchants
                loyalty = -15
            }
        }
        
        ai_will_do = {
            factor = 1
            
            modifier = {
                factor = 0
                
                NOT = {
                    estate_loyalty = {
                        estate = estate_merchants
                        loyalty = 50
                    }    
                }
            }
        }
    }
    
    # Wipe Debt
    interaction = {
        name = "WIPE_DEBT"
        icon = 1
        
        years_between_use = 20
        
        potential = { }
        
        trigger = {
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }    
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }            
        }
        
        effect = {
            remove_scaled_inflation = { ESTATE = estate_merchants }
            
            add_estate_influence_modifier = {
                estate = estate_merchants
                desc = EST_VAL_WIPED_DEBT
                influence = 15
                duration = 7200
            }
        }
        
        ai_will_do = {
			factor = 1

			modifier = {
				factor = 0
				
				NOT = { inflation = 10 }
			}
            
            modifier = {
                factor = 0
                
                estate_influence = {
                    estate = estate_merchants
                    influence = 60
                }                        
            }    
		}
    }
    
    # Conduct Pressgangs
    interaction = {
        name = "CONDUCT_PRESSGANGS"
        icon = 1
        
        years_between_use = 15
        
        potential = { }
        
        trigger = {
            estate_loyalty = {
                estate = estate_merchants
                loyalty = 30
            }
            estate_influence = {
                estate = estate_merchants
                influence = 40
            }
        }
        
        effect = {
            add_scaled_yearly_sailors = { ESTATE = estate_merchants }
            
            add_estate_loyalty = {
                estate = estate_merchants
                loyalty = -15
            }
        }
        
        ai_will_do = {
            factor = 1
            modifier = {
                factor = 0
                NOT = {
                    estate_loyalty = {
                        estate = estate_merchants
                        loyalty = 50
                    }    
                }
            }
            modifier = {
                factor = 0
                sailors_percentage = 0.25                
            }
            modifier = {
                factor = 0
                is_at_war = no
            }            
        }
    }
}